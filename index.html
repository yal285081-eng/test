<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mr. Thayer's Class ğŸ“</title>
    <link href="https://fonts.googleapis.com/css2?family=Fredoka:wght@500&family=Permanent+Marker&family=Tajawal:wght@500;800&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    
    <script type="importmap">
      {
        "imports": {
          "@google/generative-ai": "https://esm.run/@google/generative-ai"
        }
      }
    </script>

    <style>
        body { background-color: #2c3e50; color: white; font-family: 'Tajawal', sans-serif; margin: 0; text-align: center; overflow-x: hidden; padding-bottom: 90px; user-select: none; -webkit-tap-highlight-color: transparent; }
        header { background: #e74c3c; padding: 20px; box-shadow: 0 4px 0 #c0392b; transform: rotate(-1deg); margin-bottom: 30px; position: relative; z-index: 10; }
        header h1 { margin: 0; font-family: 'Permanent Marker', cursive; font-size: 2.2rem; letter-spacing: 1px; }
        header p { margin: 5px 0 0; font-weight: bold; }
        .profile-container { position: relative; display: inline-block; margin-top: 10px; transition: transform 0.3s; cursor: pointer; z-index: 20; }
        .playing-animation { animation: shake 0.3s infinite; border-color: #f1c40f !important; box-shadow: 0 0 25px #f1c40f, 0 0 10px #f1c40f inset !important; }
        @keyframes shake { 0% { transform: rotate(0deg); } 25% { transform: rotate(-3deg); } 50% { transform: rotate(3deg); } 75% { transform: rotate(-3deg); } 100% { transform: rotate(0deg); } }
        .profile-img { width: 170px; height: 170px; object-fit: cover; border-radius: 50%; border: 5px solid white; box-shadow: 0 10px 20px rgba(0,0,0,0.3); background: #fff; transition: all 0.2s; }
        .badge { position: absolute; bottom: 5px; right: -5px; background: #f1c40f; color: #333; padding: 5px 12px; border-radius: 15px; font-weight: bold; font-family: 'Permanent Marker', cursive; transform: rotate(-10deg); border: 2px solid white; box-shadow: 0 2px 5px rgba(0,0,0,0.2); }
        .side-emoji { position: absolute; top: 50%; transform: translateY(-50%); font-size: 2.5rem; cursor: pointer; z-index: 25; transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275); filter: drop-shadow(0 5px 5px rgba(0,0,0,0.3)); text-decoration: none; }
        .emoji-left { left: -50px; }
        .emoji-right { right: -50px; }
        .click-hint { display: block; font-size: 0.8rem; color: #f1c40f; margin-bottom: 5px; font-weight: bold; animation: blink 2s infinite; }
        @keyframes blink { 0%,100%{opacity:1;} 50%{opacity:0.5;} }
        .btn-wrapper { position: relative; width: 90%; max-width: 400px; margin: 30px auto 15px; display: grid; grid-template-columns: 1fr 1fr; gap: 15px; padding: 10px; }
        .action-btn { background: linear-gradient(to bottom, #3498db, #2980b9); color: white; border: none; padding: 20px 10px; font-size: 1rem; border-radius: 15px; cursor: pointer; box-shadow: 0 4px 10px rgba(52, 152, 219, 0.4); font-family: 'Tajawal', sans-serif; transition: transform 0.1s; width: 100%; height: 100px; display: flex; flex-direction: column; align-items: center; justify-content: center; }
        .quiz-center-btn { position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); width: 90px; height: 90px; border-radius: 50%; background: radial-gradient(circle, #f1c40f, #f39c12); border: 5px solid #2c3e50; color: #2c3e50; font-weight: 800; font-size: 1rem; cursor: pointer; z-index: 10; box-shadow: 0 0 20px rgba(241, 196, 15, 0.6); display: flex; align-items: center; justify-content: center; text-align: center; animation: pulseBtn 2s infinite; }
        @keyframes pulseBtn { 0% { transform: translate(-50%, -50%) scale(1); } 70% { transform: translate(-50%, -50%) scale(1.05); } 100% { transform: translate(-50%, -50%) scale(1); } }
        
        .modal-overlay { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.85); z-index: 2000; justify-content: center; align-items: center; backdrop-filter: blur(5px); }
        .secret-box { background: white; color: #333; width: 85%; max-width: 350px; padding: 40px 20px; border-radius: 20px; text-align: center; position: relative; border: 4px solid #f1c40f; animation: popIn 0.3s; }
        @keyframes popIn { from { transform: scale(0.5); opacity: 0; } to { transform: scale(1); opacity: 1; } }
        .close-icon { position: absolute; top: 10px; right: 15px; font-size: 1.8rem; font-weight: bold; cursor: pointer; color: #e74c3c; }

        /* Ø´Ø§Øª Ø¨ÙˆØª Ø³ØªØ§ÙŠÙ„ */
        #chat-icon { position: fixed; bottom: 70px; right: 20px; width: 60px; height: 60px; background: #3498db; border-radius: 50%; display: flex; align-items: center; justify-content: center; z-index: 10002; font-size: 30px; cursor: pointer; }
        #chat-window { display: none; position: fixed; bottom: 140px; right: 20px; width: 320px; height: 450px; background: #fff; border-radius: 20px; z-index: 10003; flex-direction: column; overflow: hidden; border: 3px solid #3498db; }
        .chat-header { background: #3498db; color: white; padding: 15px; text-align: right; display: flex; justify-content: space-between; align-items: center; }
        .chat-body { flex: 1; padding: 15px; overflow-y: auto; background: #f1f2f6; display: flex; flex-direction: column; gap: 10px; position: relative; scroll-behavior: smooth; }
        .chat-input-area { padding: 10px; background: white; border-top: 1px solid #ddd; display: flex; gap: 5px; }
        #chatInput { flex: 1; padding: 10px; border-radius: 20px; border: 1px solid #ddd; outline: none; font-family: 'Tajawal'; text-align: right; }
        .msg { max-width: 80%; padding: 10px 15px; border-radius: 15px; font-size: 0.9rem; line-height: 1.4; color: #333; text-align: right; }
        .msg-user { background: #3498db; color: white; align-self: flex-end; }
        .msg-bot { background: #e0e0e0; align-self: flex-start; }

        /* Ø£Ù†ÙŠÙ…ÙŠØ´Ù† Ø§Ù„Ù†Ù‚Ø§Ø· */
        .typing-dots { display: none; align-self: flex-start; background: #e0e0e0; padding: 10px 15px; border-radius: 15px; margin-bottom: 5px; }
        .dot { height: 8px; width: 8px; background: #7f8c8d; border-radius: 50%; display: inline-block; animation: bounce 1.4s infinite; margin: 0 2px; }
        .dot:nth-child(2) { animation-delay: 0.2s; }
        .dot:nth-child(3) { animation-delay: 0.4s; }
        @keyframes bounce { 0%, 80%, 100% { transform: scale(0); } 40% { transform: scale(1); } }
        
        #scroll-down-btn { position: absolute; bottom: 70px; left: 50%; transform: translateX(-50%); background: #3498db; color: white; border-radius: 50%; width: 30px; height: 30px; display: none; align-items: center; justify-content: center; cursor: pointer; box-shadow: 0 2px 5px rgba(0,0,0,0.2); z-index: 10; }

        .news-container { position: fixed; bottom: 0; left: 0; width: 100%; height: 50px; background: #c0392b; border-top: 4px solid #f1c40f; z-index: 9999; display: flex; align-items: center; }
        .ticker-text { font-family: 'Tajawal', sans-serif; font-weight: bold; font-size: 1.2rem; color: white; width: 100%; }
    </style>
</head>
<body>

    <div id="chat-icon" onclick="toggleChat()">ğŸ’¬</div>
    <div id="chat-window">
        <div class="chat-header"><span onclick="toggleChat()" style="cursor:pointer">âœ–</span><span>Thaer Bot (AI) ğŸ§ </span></div>
        <div class="chat-body" id="chatBody">
            <div id="scroll-down-btn" onclick="scrollToBottom()">â†“</div>
            <div class="msg msg-bot">Ù‡Ù„Ø§ Ø·Ù„Ø§Ø¨ÙŠ Ø§Ù„ØºÙˆØ§Ù„ÙŠ! Ø¢Ù†ÙŠ Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯ Ø§Ù„Ø°ÙƒÙŠ Ù„Ù„Ø£Ø³ØªØ§Ø° Ø«Ø§Ø¦Ø±.. Ø´Ù„ÙˆÙ† Ø£Ø³Ø§Ø¹Ø¯ÙƒÙ… Ø§Ù„ÙŠÙˆÙ…ØŸ ğŸ˜</div>
            <div class="typing-dots" id="typingIndicator">
                <div class="dot"></div><div class="dot"></div><div class="dot"></div>
            </div>
        </div>
        <div class="chat-input-area">
            <button id="sendBtn" onclick="sendMessage()" style="background:#3498db; color:white; border:none; padding:10px; border-radius:50%; cursor:pointer;">â¤</button>
            <input type="text" id="chatInput" placeholder="Ø§ÙƒØªØ¨ Ø±Ø³Ø§Ù„ØªÙƒ Ù‡Ù†Ø§..." onkeypress="if(event.key==='Enter') sendMessage()">
        </div>
    </div>

    <header>
        <h1>Mr.Thaer ğŸ‡®ğŸ‡¶</h1>
        <p>The King of English / Ù…Ù„Ùƒ Ø§Ù„Ù„ØºØ© Ø§Ù„Ø§Ù†Ø¬Ù„ÙŠØ²ÙŠØ©</p>
    </header>

    <div class="profile-container" onclick="handleImageClick()">
        <span class="click-hint">ğŸµ Ø§Ø¶ØºØ· Ù„Ù„ØªØ´ØºÙŠÙ„ / Ø§Ù„Ø¥ÙŠÙ‚Ø§Ù ğŸµ</span>
        <div class="side-emoji emoji-left">âœ‰ï¸</div>
        <a href="https://youtube.com/@mrthaer-yo9zn" target="_blank" class="side-emoji emoji-right">ğŸ¬</a>
        <img src="img1.jpg" id="teacherImg" alt="Mr. Thayer" class="profile-img">
        <div class="badge">Top Teacher</div>
    </div>

    <div class="btn-wrapper">
        <button class="action-btn" onclick="openHomework()">ğŸ“š<br>Ø§Ù„ÙˆØ§Ø¬Ø¨</button>
        <button class="action-btn google-btn" onclick="window.open('https://translate.google.com')">ğŸŒ<br>Ø§Ù„Ù…ØªØ±Ø¬Ù…</button>
        <button class="quiz-center-btn" onclick="openQuiz()">Ø§Ø®ØªØ¨Ø§Ø±</button>
        <button class="action-btn predict-btn" onclick="alert('ØªÙˆÙ‚Ø¹ Ø§Ù„Ø£Ø³ØªØ§Ø°: Ø±Ø§Ø­ ØªØ¬ÙŠØ¨ Ø¯Ø±Ø¬Ø© ÙƒØ§Ù…Ù„Ø© ÙŠØ§ Ø¨Ø·Ù„! ğŸ”¥')">ğŸ”®<br>ØªÙˆÙ‚Ø¹ Ù†ØªÙŠØ¬ØªÙƒ</button>
        <button class="action-btn prank-btn" onclick="alert('Ù…Ø­Ø§ÙˆÙ„Ø© ÙØ§Ø´Ù„Ø©! Ø§Ù„Ø£Ø³ØªØ§Ø° ÙƒØ´ÙÙƒØŒ Ø±ÙˆØ­ Ø§Ù‚Ø±Ø§ ğŸ˜‚')">âš ï¸<br>Ø¥Ù„ØºØ§Ø¡ Ø§Ù„Ø§Ù…ØªØ­Ø§Ù†</button>
    </div>

    <div id="modalHomework" class="modal-overlay">
        <div class="secret-box">
            <span class="close-icon" onclick="closeModal('modalHomework')">Ã—</span>
            <p style="font-size:1.5rem; font-weight:800; color:#2c3e50;">Ù„Ø§ ÙŠÙˆØ¬Ø¯ ÙˆØ§Ø¬Ø¨ Ø­Ø§Ù„ÙŠØ§Ù‹ ğŸŒŸ</p>
        </div>
    </div>

    <div id="modalQuiz" class="modal-overlay">
        <div class="secret-box" style="border-color:#e67e22;">
            <span class="close-icon" onclick="closeModal('modalQuiz')">Ã—</span>
            <p style="font-size:1.5rem; font-weight:800; color:#2c3e50;">Ù„Ø§ ÙŠØªÙˆÙØ± Ø§Ø®ØªØ¨Ø§Ø± Ø­Ø§Ù„ÙŠØ§Ù‹ ğŸ“–</p>
        </div>
    </div>

    <div class="news-container">
        <marquee class="ticker-text" behavior="scroll" direction="right" scrollamount="10">
            ğŸŒŸ Ù…Ø±Ø­Ø¨Ø§ Ø¨ÙŠÙƒÙ… Ø·Ù„Ø§Ø¨Ù†Ø§ Ø§Ù„Ø§Ø¹Ø²Ø§Ø¡ ÙÙŠ ØµÙØ­Ø© Ø§Ù„Ø§Ø³ØªØ§Ø° Ø«Ø§Ø¦Ø± Ø§Ù„ØªØ¹Ù„ÙŠÙ…ÙŠØ©.. Ø£Ù†ØªÙ… Ø¬ÙŠÙ„ Ø§Ù„Ù…Ø³ØªÙ‚Ø¨Ù„ ÙˆÙØ®Ø± Ø§Ù„Ø¹Ø±Ø§Ù‚ ğŸ‡®ğŸ‡¶ .. Ù…Ø¹Ø§ Ø³Ù†Ø¬Ø¹Ù„ Ø§Ù„Ù„ØºØ© Ø§Ù„Ø§Ù†Ø¬Ù„ÙŠØ²ÙŠØ© Ø£Ø³Ù‡Ù„ ÙˆØ£Ù…ØªØ¹ .. Ø£Ù‡Ù„Ø§ Ø¨Ø·Ù„Ø¨Ø© Ø§Ù„Ø¹Ù„Ù… ÙˆØ§Ù„Ù…Ø¨Ø¯Ø¹ÙŠÙ† ğŸ‰
        </marquee>
    </div>

    <script type="module">
        import { GoogleGenerativeAI } from "https://esm.run/@google/generative-ai";

        const API_KEY = "PASTE_YOUR_KEY_HERE"; 
        const genAI = new GoogleGenerativeAI(API_KEY);
        let chatHistory = [{ role: "user", parts: [{ text: "Ø£Ù†Øª Ø£Ø³ØªØ§Ø° Ø«Ø§Ø¦Ø±ØŒ Ù…Ø¯Ø±Ø³ Ù„ØºØ© Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ© Ø¹Ø±Ø§Ù‚ÙŠ Ù…Ø­Ø¨ÙˆØ¨. ØªØ­ÙƒÙŠ Ø¨Ù„Ù‡Ø¬Ø© Ø¹Ø±Ø§Ù‚ÙŠØ© Ù‚ÙˆÙŠØ© ÙˆÙ†ÙƒØ§Øª Ø®ÙÙŠÙØ©. Ù„Ø§ ØªØªØ¯Ø®Ù„ Ø¨Ø§Ù„Ø³ÙŠØ§Ø³Ø© Ø£Ùˆ Ø§Ù„Ø¯ÙŠÙ†." }] }];

        var mySong = new Audio('song.mp3'); 
        window.isPlaying = false;

        window.handleImageClick = function() {
            var img = document.getElementById('teacherImg');
            if (window.isPlaying) {
                mySong.pause();
                window.isPlaying = false;
                img.classList.remove('playing-animation');
            } else {
                mySong.play();
                window.isPlaying = true;
                img.classList.add('playing-animation');
                confetti();
            }
        }

        window.toggleChat = function() {
            var win = document.getElementById('chat-window');
            win.style.display = (win.style.display === 'flex') ? 'none' : 'flex';
        }

        window.sendMessage = async function() {
            var input = document.getElementById('chatInput');
            var msg = input.value.trim();
            if (!msg) return;

            addMsg(msg, 'user');
            input.value = '';
            
            const typing = document.getElementById('typingIndicator');
            typing.style.display = 'block';
            scrollToBottom();

            try {
                const model = genAI.getGenerativeModel({ model: "gemini-1.5-flash" });
                const chat = model.startChat({ history: chatHistory });
                const result = await chat.sendMessage(msg);
                const response = await result.response;
                
                setTimeout(() => {
                    typing.style.display = 'none';
                    addMsg(response.text(), 'bot');
                    scrollToBottom();
                }, 6000);
            } catch (e) {
                typing.style.display = 'none';
                addMsg("Ø¹Ø°Ø±Ø§Ù‹ØŒ ÙØµÙ„ Ø¹Ù†Ø¯ÙŠ Ø§Ù„Ù†Øª. Ø¬Ø±Ø¨ Ù…Ø±Ø© Ø«Ø§Ù†ÙŠØ©!", 'bot');
            }
        }

        function addMsg(text, type) {
            var div = document.createElement('div');
            div.className = 'msg ' + (type === 'user' ? 'msg-user' : 'msg-bot');
            div.innerText = text;
            var chatBody = document.getElementById('chatBody');
            chatBody.insertBefore(div, document.getElementById('typingIndicator'));
        }

        window.scrollToBottom = function() {
            var chatBody = document.getElementById('chatBody');
            chatBody.scrollTop = chatBody.scrollHeight;
        }

        const chatBody = document.getElementById('chatBody');
        chatBody.onscroll = function() {
            const btn = document.getElementById('scroll-down-btn');
            if (chatBody.scrollTop < chatBody.scrollHeight - 600) {
                btn.style.display = 'flex';
            } else {
                btn.style.display = 'none';
            }
        }

        window.openHomework = () => document.getElementById('modalHomework').style.display = 'flex';
        window.openQuiz = () => document.getElementById('modalQuiz').style.display = 'flex';
        window.closeModal = (id) => document.getElementById(id).style.display = 'none';
    </script>
</body>
</html>
