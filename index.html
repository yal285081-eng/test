<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mr. Thayer's Class ğŸ“</title>
    <link href="https://fonts.googleapis.com/css2?family=Fredoka:wght@500&family=Permanent+Marker&family=Tajawal:wght@500;800&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>

    <style>
        /* Ø§Ù„Ø³ØªØ§ÙŠÙ„Ø§Øª Ø§Ù„Ø£ØµÙ„ÙŠØ© ÙƒÙ…Ø§ Ù‡ÙŠ */
        body { background-color: #2c3e50; color: white; font-family: 'Tajawal', sans-serif; margin: 0; text-align: center; overflow-x: hidden; padding-bottom: 90px; user-select: none; -webkit-tap-highlight-color: transparent; }
        header { background: #e74c3c; padding: 20px; box-shadow: 0 4px 0 #c0392b; transform: rotate(-1deg); margin-bottom: 30px; position: relative; z-index: 10; }
        header h1 { margin: 0; font-family: 'Permanent Marker', cursive; font-size: 2.2rem; letter-spacing: 1px; }
        header p { margin: 5px 0 0; font-weight: bold; }
        .profile-container { position: relative; display: inline-block; margin-top: 10px; transition: transform 0.3s; cursor: pointer; z-index: 20; }
        .playing-animation { animation: shake 0.3s infinite; border-color: #f1c40f !important; box-shadow: 0 0 25px #f1c40f, 0 0 10px #f1c40f inset !important; }
        @keyframes shake { 0% { transform: rotate(0deg); } 25% { transform: rotate(-3deg); } 50% { transform: rotate(3deg); } 75% { transform: rotate(-3deg); } 100% { transform: rotate(0deg); } }
        .profile-img { width: 170px; height: 170px; object-fit: cover; border-radius: 50%; border: 5px solid white; box-shadow: 0 10px 20px rgba(0,0,0,0.3); background: #fff; transition: all 0.2s; }
        .badge { position: absolute; bottom: 5px; right: -5px; background: #f1c40f; color: #333; padding: 5px 12px; border-radius: 15px; font-weight: bold; transform: rotate(-10deg); border: 2px solid white; }
        .side-emoji { position: absolute; top: 50%; transform: translateY(-50%); font-size: 2.5rem; cursor: pointer; z-index: 25; transition: all 0.3s; text-decoration: none; }
        .emoji-left { left: -50px; }
        .emoji-right { right: -50px; }
        .btn-wrapper { position: relative; width: 90%; max-width: 400px; margin: 30px auto 15px; display: grid; grid-template-columns: 1fr 1fr; gap: 15px; padding: 10px; }
        .action-btn { background: linear-gradient(to bottom, #3498db, #2980b9); color: white; border: none; padding: 20px 10px; font-size: 1rem; border-radius: 15px; cursor: pointer; font-family: 'Tajawal', sans-serif; height: 100px; display: flex; flex-direction: column; align-items: center; justify-content: center; }
        .quiz-center-btn { position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); width: 90px; height: 90px; border-radius: 50%; background: radial-gradient(circle, #f1c40f, #f39c12); border: 5px solid #2c3e50; color: #2c3e50; font-weight: 800; font-size: 1rem; cursor: pointer; z-index: 10; display: flex; align-items: center; justify-content: center; text-align: center; animation: pulseBtn 2s infinite; }
        @keyframes pulseBtn { 0% { transform: translate(-50%, -50%) scale(1); } 70% { transform: translate(-50%, -50%) scale(1.05); } 100% { transform: translate(-50%, -50%) scale(1); } }
        
        /* Ø´Ø§Øª Ø¨ÙˆØª */
        #chat-icon { position: fixed; bottom: 70px; right: 20px; width: 60px; height: 60px; background: #3498db; border-radius: 50%; display: flex; align-items: center; justify-content: center; z-index: 10002; font-size: 30px; cursor: pointer; }
        #chat-window { display: none; position: fixed; bottom: 140px; right: 20px; width: 320px; height: 450px; background: #fff; border-radius: 20px; z-index: 10003; flex-direction: column; overflow: hidden; border: 3px solid #3498db; }
        .chat-header { background: #3498db; color: white; padding: 15px; display: flex; justify-content: space-between; align-items: center; }
        .chat-body { flex: 1; padding: 15px; overflow-y: auto; background: #f1f2f6; display: flex; flex-direction: column; gap: 10px; position: relative; scroll-behavior: smooth; }
        .chat-input-area { padding: 10px; background: white; border-top: 1px solid #ddd; display: flex; gap: 5px; }
        #chatInput { flex: 1; padding: 10px; border-radius: 20px; border: 1px solid #ddd; outline: none; font-family: 'Tajawal'; text-align: right; }
        .msg { max-width: 80%; padding: 10px 15px; border-radius: 15px; font-size: 0.9rem; line-height: 1.4; text-align: right; }
        .msg-user { background: #3498db; color: white; align-self: flex-end; }
        .msg-bot { background: #e0e0e0; color: #333; align-self: flex-start; }

        /* ÙÙ‚Ø§Ø¹Ø© Ø§Ù„Ù†Ù‚Ø§Ø· */
        .typing-dots { display: none; align-self: flex-start; background: #e0e0e0; padding: 10px 15px; border-radius: 15px; margin-bottom: 5px; }
        .dot { height: 8px; width: 8px; background: #7f8c8d; border-radius: 50%; display: inline-block; animation: bounce 1.4s infinite; margin: 0 2px; }
        .dot:nth-child(2) { animation-delay: 0.2s; }
        .dot:nth-child(3) { animation-delay: 0.4s; }
        @keyframes bounce { 0%, 80%, 100% { transform: scale(0); } 40% { transform: scale(1); } }
        #scroll-down-btn { position: absolute; bottom: 70px; left: 50%; transform: translateX(-50%); background: #3498db; color: white; border-radius: 50%; width: 30px; height: 30px; display: none; align-items: center; justify-content: center; cursor: pointer; z-index: 10; }

        /* Ø§Ù„Ù…ÙˆØ¯Ø§Ù„ */
        .modal-overlay { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.85); z-index: 2000; justify-content: center; align-items: center; backdrop-filter: blur(5px); }
        .secret-box { background: white; color: #333; width: 85%; max-width: 350px; padding: 40px 20px; border-radius: 20px; text-align: center; position: relative; border: 4px solid #f1c40f; }
        .close-icon { position: absolute; top: 10px; right: 15px; font-size: 1.8rem; font-weight: bold; cursor: pointer; color: #e74c3c; }

        .news-container { position: fixed; bottom: 0; left: 0; width: 100%; height: 50px; background: #c0392b; border-top: 4px solid #f1c40f; z-index: 9999; display: flex; align-items: center; }
        .ticker-text { font-family: 'Tajawal', sans-serif; font-weight: bold; font-size: 1.2rem; color: white; width: 100%; }
    </style>
</head>
<body>

    <div id="chat-icon" onclick="toggleChat()">ğŸ’¬</div>
    <div id="chat-window">
        <div class="chat-header"><span onclick="toggleChat()" style="cursor:pointer">âœ–</span><span>Thaer Bot (AI) ğŸ§ </span></div>
        <div class="chat-body" id="chatBody">
            <div id="scroll-down-btn" onclick="scrollToBottom()">â†“</div>
            <div class="msg msg-bot">Ù‡Ù„Ø§ Ø·Ù„Ø§Ø¨ÙŠ Ø§Ù„ØºÙˆØ§Ù„ÙŠ! Ø¢Ù†ÙŠ Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯ Ø§Ù„Ø°ÙƒÙŠ Ù„Ù„Ø£Ø³ØªØ§Ø° Ø«Ø§Ø¦Ø±.. Ø´Ù„ÙˆÙ† Ø£Ø³Ø§Ø¹Ø¯ÙƒÙ… Ø§Ù„ÙŠÙˆÙ…ØŸ ğŸ˜</div>
            <div class="typing-dots" id="typingIndicator">
                <div class="dot"></div><div class="dot"></div><div class="dot"></div>
            </div>
        </div>
        <div class="chat-input-area">
            <button onclick="sendMessage()" style="background:#3498db; color:white; border:none; padding:10px; border-radius:50%; cursor:pointer;">â¤</button>
            <input type="text" id="chatInput" placeholder="Ø§ÙƒØªØ¨ Ø±Ø³Ø§Ù„ØªÙƒ..." onkeypress="if(event.key==='Enter') sendMessage()">
        </div>
    </div>

    <header>
        <h1>Mr.Thaer ğŸ‡®ğŸ‡¶</h1>
        <p>The King of English / Ù…Ù„Ùƒ Ø§Ù„Ù„ØºØ© Ø§Ù„Ø§Ù†Ø¬Ù„ÙŠØ²ÙŠØ©</p>
    </header>

    <div class="profile-container" onclick="handleImageClick()">
        <span class="click-hint">ğŸµ Ø§Ø¶ØºØ· Ù„Ù„ØªØ´ØºÙŠÙ„ / Ø§Ù„Ø¥ÙŠÙ‚Ø§Ù ğŸµ</span>
        <div class="side-emoji emoji-left">âœ‰ï¸</div>
        <a href="https://youtube.com/@mrthaer-yo9zn" target="_blank" class="side-emoji emoji-right">ğŸ¬</a>
        <img src="img1.jpg" id="teacherImg" alt="Mr. Thayer" class="profile-img">
        <div class="badge">Top Teacher</div>
    </div>

    <div class="btn-wrapper">
        <button class="action-btn" onclick="openModal('modalHomework')">ğŸ“š<br>Ø§Ù„ÙˆØ§Ø¬Ø¨</button>
        <button class="action-btn" onclick="window.open('https://translate.google.com')">ğŸŒ<br>Ø§Ù„Ù…ØªØ±Ø¬Ù…</button>
        <button class="quiz-center-btn" onclick="openModal('modalQuiz')">Ø§Ø®ØªØ¨Ø§Ø±</button>
        <button class="action-btn" onclick="alert('ØªÙˆÙ‚Ø¹ Ø§Ù„Ø£Ø³ØªØ§Ø°: 100% ÙŠØ§ Ø¨Ø·Ù„! ğŸ”¥')">ğŸ”®<br>ØªÙˆÙ‚Ø¹ Ù†ØªÙŠØ¬ØªÙƒ</button>
        <button class="action-btn" onclick="alert('Ø±ÙˆØ­ Ø§Ù‚Ø±Ø§ Ø£Ø­Ø³Ù†Ù„Ùƒ ğŸ˜‚')">âš ï¸<br>Ø¥Ù„ØºØ§Ø¡ Ø§Ù„Ø§Ù…ØªØ­Ø§Ù†</button>
    </div>

    <div id="modalHomework" class="modal-overlay">
        <div class="secret-box">
            <span class="close-icon" onclick="closeModal('modalHomework')">Ã—</span>
            <p style="font-size:1.5rem; font-weight:800; color:#2c3e50;">Ù„Ø§ ÙŠÙˆØ¬Ø¯ ÙˆØ§Ø¬Ø¨ Ø­Ø§Ù„ÙŠØ§Ù‹ ğŸŒŸ</p>
        </div>
    </div>

    <div id="modalQuiz" class="modal-overlay">
        <div class="secret-box" style="border-color:#e67e22;">
            <span class="close-icon" onclick="closeModal('modalQuiz')">Ã—</span>
            <p style="font-size:1.5rem; font-weight:800; color:#2c3e50;">Ù„Ø§ ÙŠØªÙˆÙØ± Ø§Ø®ØªØ¨Ø§Ø± Ø­Ø§Ù„ÙŠØ§Ù‹ ğŸ“–</p>
        </div>
    </div>

    <div class="news-container">
        <marquee class="ticker-text" behavior="scroll" direction="right" scrollamount="10">
            ğŸŒŸ Ù…Ø±Ø­Ø¨Ø§ Ø¨ÙŠÙƒÙ… Ø·Ù„Ø§Ø¨Ù†Ø§ Ø§Ù„Ø§Ø¹Ø²Ø§Ø¡ ÙÙŠ ØµÙØ­Ø© Ø§Ù„Ø§Ø³ØªØ§Ø° Ø«Ø§Ø¦Ø± Ø§Ù„ØªØ¹Ù„ÙŠÙ…ÙŠØ©.. Ø£Ù†ØªÙ… Ø¬ÙŠÙ„ Ø§Ù„Ù…Ø³ØªÙ‚Ø¨Ù„ ÙˆÙØ®Ø± Ø§Ù„Ø¹Ø±Ø§Ù‚ ğŸ‡®ğŸ‡¶ .. Ù…Ø¹Ø§ Ø³Ù†Ø¬Ø¹Ù„ Ø§Ù„Ù„ØºØ© Ø§Ù„Ø§Ù†Ø¬Ù„ÙŠØ²ÙŠØ© Ø£Ø³Ù‡Ù„ ÙˆØ£Ù…ØªØ¹ ğŸ‰
        </marquee>
    </div>

    <script>
        // --- Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø°ÙƒØ§Ø¡ (Ø·Ø±ÙŠÙ‚Ø© FETCH Ø§Ù„Ù…Ø¶Ù…ÙˆÙ†Ø©) ---
        const API_KEY = "AIzaSyC5pGUCq_ao3Ba9FRji7NjHFQszvGNAHkY";
        let chatHistory = [
            { role: "user", parts: [{ text: "Ø£Ù†Øª Ø£Ø³ØªØ§Ø° Ø«Ø§Ø¦Ø±ØŒ Ù…Ø¯Ø±Ø³ Ù„ØºØ© Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ© Ø¹Ø±Ø§Ù‚ÙŠ Ù…Ø­Ø¨ÙˆØ¨ ØªØ­ÙƒÙŠ Ø¨Ù„Ù‡Ø¬Ø© Ø¹Ø±Ø§Ù‚ÙŠØ© Ù‚ÙˆÙŠØ©ØŒ ØªØ­Ø¨ Ø§Ù„Ù†ÙƒØ§ØªØŒ ØªØ´Ø±Ø­ Ø§Ù„Ù‚ÙˆØ§Ø¹Ø¯ Ø¨ÙˆØ¶ÙˆØ­ Ø¨Ù„Ù‡Ø¬Ø© Ø¨Ø³ÙŠØ·Ø©ØŒ ÙˆØªØ¹ØªØ¨Ø± Ø§Ù„Ø·Ù„Ø§Ø¨ Ø§Ø®ÙˆØªÙƒ. Ù…Ù…Ù†ÙˆØ¹ Ø§Ù„Ø³ÙŠØ§Ø³Ø© ÙˆØ§Ù„Ø¯ÙŠÙ†." }] },
            { role: "model", parts: [{ text: "ØµØ§Ø± ØªØ¯Ù„Ù„! Ø¢Ù†ÙŠ Ø¬Ø§Ù‡Ø²." }] }
        ];

        async function sendMessage() {
            const input = document.getElementById('chatInput');
            const msg = input.value.trim();
            if (!msg) return;

            addMsgUI(msg, 'user');
            input.value = '';
            
            const typing = document.getElementById('typingIndicator');
            typing.style.display = 'flex';
            scrollToBottom();

            try {
                // Ø§Ø³ØªØ®Ø¯Ø§Ù… FETCH Ø§Ù„Ù…Ø¨Ø§Ø´Ø± (Ù†ÙØ³ ÙÙƒØ±Ø© Ø§Ù„ÙƒÙˆØ¯ Ø§Ù„Ø£ÙˆÙ„ Ø§Ù„Ø´ØºØ§Ù„ Ø¹Ù†Ø¯Ùƒ)
                const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash:generateContent?key=${API_KEY}`, {
                    method: "POST",
                    headers: { "Content-Type": "application/json" },
                    body: JSON.stringify({ contents: chatHistory.concat([{ role: "user", parts: [{ text: msg }] }]) })
                });

                const data = await response.json();
                const aiReply = data.candidates[0].content.parts[0].text;

                // ØªØ£Ø®ÙŠØ± 6 Ø«ÙˆØ§Ù†ÙŠ Ù„Ù„Ø±Ø¯
                setTimeout(() => {
                    typing.style.display = 'none';
                    addMsgUI(aiReply, 'bot');
                    chatHistory.push({ role: "user", parts: [{ text: msg }] });
                    chatHistory.push({ role: "model", parts: [{ text: aiReply }] });
                    scrollToBottom();
                }, 6000);

            } catch (error) {
                typing.style.display = 'none';
                addMsgUI("ÙØµÙ„ Ø¹Ù†Ø¯ÙŠ Ø§Ù„Ù†Øª! Ø­Ø§ÙˆÙ„ Ù…Ø±Ø© Ø«Ø§Ù†ÙŠØ© ÙŠØ§ Ø¨Ø·Ù„.", 'bot');
            }
        }

        function addMsgUI(text, type) {
            const div = document.createElement('div');
            div.className = 'msg ' + (type === 'user' ? 'msg-user' : 'msg-bot');
            div.innerText = text;
            const chatBody = document.getElementById('chatBody');
            chatBody.insertBefore(div, document.getElementById('typingIndicator'));
        }

        function toggleChat() {
            const win = document.getElementById('chat-window');
            win.style.display = (win.style.display === 'flex') ? 'none' : 'flex';
            if(win.style.display === 'flex') scrollToBottom();
        }

        function scrollToBottom() {
            const cb = document.getElementById('chatBody');
            cb.scrollTop = cb.scrollHeight;
        }

        // --- Ø§Ù„Ø£ØºÙ†ÙŠØ© ÙˆØ§Ù„Ù…Ø¤Ø«Ø±Ø§Øª ---
        var mySong = new Audio('song.mp3'); mySong.loop = true;
        window.isPlaying = false;
        function handleImageClick() {
            var img = document.getElementById('teacherImg');
            if (window.isPlaying) {
                mySong.pause(); window.isPlaying = false;
                img.classList.remove('playing-animation');
            } else {
                mySong.play(); window.isPlaying = true;
                img.classList.add('playing-animation');
                confetti();
            }
        }

        function openModal(id) { document.getElementById(id).style.display = 'flex'; if(id==='modalHomework') confetti(); }
        function closeModal(id) { document.getElementById(id).style.display = 'none'; }

        // Ø³Ù‡Ù… Ø§Ù„Ù†Ø²ÙˆÙ„
        document.getElementById('chatBody').onscroll = function() {
            const btn = document.getElementById('scroll-down-btn');
            if (this.scrollTop < this.scrollHeight - 600) btn.style.display = 'flex';
            else btn.style.display = 'none';
        };
    </script>
</body>
</html>
